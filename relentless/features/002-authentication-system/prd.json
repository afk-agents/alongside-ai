{
  "project": "Tasks: Authentication System",
  "branchName": "ralph/002-tasks-authentication-system",
  "description": "",
  "userStories": [
    {
      "id": "US-001",
      "title": "New User Registration",
      "description": "",
      "acceptanceCriteria": [
        "User can navigate to /signup page",
        "Form validates email format before submission",
        "Form validates password minimum length (8 chars)",
        "Successful signup creates user account",
        "Successful signup auto-creates profile with role=\"guest\"",
        "User is automatically logged in after signup",
        "User is redirected to homepage after signup",
        "Duplicate email shows appropriate error message",
        "Typecheck passes (`bunx tsc --noEmit`)",
        "Lint passes (`bun run lint`)",
        "T004 [P] [US-001] Create `components/auth/SignupForm.tsx` with email/password inputs and client-side validation",
        "T005 [US-001] Create `app/(auth)/signup/page.tsx` that renders SignupForm",
        "T006 [US-001] Add form validation: email format check, password minimum 8 characters",
        "T007 [US-001] Handle signup errors: display \"An account with this email already exists\" for duplicates",
        "T008 [US-001] Redirect to homepage on successful signup",
        "T009 [US-001] Verify profile auto-created with role=\"guest\" and profileStatus=\"locked\""
      ],
      "priority": 1,
      "passes": true,
      "notes": "Completed with Phase 1 setup (T001-T003) and US-001 tasks (T004-T009)",
      "phase": "Stories"
    },
    {
      "id": "US-002",
      "title": "User Login",
      "description": "",
      "acceptanceCriteria": [
        "User can navigate to /login page",
        "Successful login authenticates user",
        "User is redirected to homepage after login",
        "Invalid credentials show \"Invalid email or password\" (not specific error)",
        "Already logged-in users are redirected away from /login",
        "Typecheck passes",
        "Lint passes",
        "T010 [P] [US-002] Create `components/auth/LoginForm.tsx` with email/password inputs",
        "T011 [US-002] Create `app/(auth)/login/page.tsx` that renders LoginForm",
        "T012 [US-002] Handle login errors: display generic \"Invalid email or password\" message",
        "T013 [US-002] Redirect to homepage on successful login",
        "T014 [US-002] Redirect authenticated users away from /login to homepage"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Completed - LoginForm.tsx and login page created with generic error messages and auth redirect",
      "phase": "Stories"
    },
    {
      "id": "US-003",
      "title": "User Logout",
      "description": "",
      "acceptanceCriteria": [
        "Logout button visible when user is authenticated",
        "Logout button not visible when user is not authenticated",
        "Clicking logout terminates the session",
        "User is redirected to homepage after logout",
        "Typecheck passes",
        "Lint passes",
        "T015 [P] [US-003] Create `components/auth/SignOutButton.tsx` component",
        "T016 [US-003] Add SignOutButton to app layout (visible when authenticated)",
        "T017 [US-003] Redirect to homepage after logout"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Completed - SignOutButton.tsx and AuthNav.tsx created with conditional visibility based on auth state",
      "phase": "Stories"
    },
    {
      "id": "US-004",
      "title": "Session Persistence",
      "description": "",
      "acceptanceCriteria": [
        "Logged-in user remains logged in after browser restart",
        "Session token stored in HTTP-only cookie",
        "Expired sessions require re-authentication",
        "Typecheck passes",
        "Lint passes",
        "T018 [US-004] Verify ConvexAuthNextjsProvider handles session persistence via cookies",
        "T019 [US-004] Test session persistence across browser close/reopen",
        "T020 [US-004] Verify session expiration works as expected (default @convex-dev/auth behavior)"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Completed - middleware.ts created with cookieConfig.maxAge for 30-day persistent cookies. Session persistence handled by ConvexAuthNextjsProvider with HTTP-only cookies. Session expiration uses @convex-dev/auth defaults (30 days).",
      "phase": "Stories"
    },
    {
      "id": "US-005",
      "title": "Role-Based Access Control",
      "description": "",
      "acceptanceCriteria": [
        "Unauthenticated users redirected to /login when accessing protected routes",
        "Users with role=\"guest\" cannot access member-only routes",
        "Users with role=\"member\" cannot access admin routes",
        "Users with role=\"admin\" can access admin routes",
        "Server-side role checking available via helper functions",
        "Typecheck passes",
        "Lint passes",
        "T021 [P] [US-005] Create `middleware.ts` with route protection logic",
        "T022 [US-005] Add helper function `requireAuth` in `convex/users.ts` for server-side auth checks",
        "T023 [US-005] Add helper function `requireRole` in `convex/users.ts` for role-based access",
        "T024 [US-005] Configure middleware to redirect unauthenticated users to /login for protected routes",
        "T025 [US-005] Configure middleware to show 403 for unauthorized role access"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Completed - middleware.ts updated with route matchers and auth redirects. requireAuth and requireRole helper functions added to convex/users.ts. Admin and member pages created with ForbiddenPage component for 403 errors.",
      "phase": "Stories"
    },
    {
      "id": "US-006",
      "title": "Auto-Create Account on Purchase (DEFERRED)",
      "description": "DEFERRED to F11 (Event Registration Flow) as it requires Stripe integration. This story will be implemented when the checkout flow is built.",
      "acceptanceCriteria": [
        "Guest checkout creates user account with provided email",
        "Existing users are not duplicated",
        "New users have profile with role=\"guest\"",
        "T026 [US-006] Create internal mutation `createUserFromPurchase` in `convex/users.ts`",
        "T027 [US-006] Integrate with event purchase flow (F11)"
      ],
      "priority": 6,
      "passes": true,
      "notes": "DEFERRED to F11 (Event Registration Flow). This story cannot be implemented without Stripe checkout integration. Integration point documented in progress.txt for F11 implementation. The core authentication system (US-001 through US-005) is complete.",
      "phase": "Stories"
    }
  ]
}